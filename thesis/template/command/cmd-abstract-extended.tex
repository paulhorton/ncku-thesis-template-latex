%
% This file is part of the project of
% National Cheng Kung University (NCKU) Thesis/Dissertation Template in LaTex.
% This project is hold at
%     <https://github.com/wengan-li/ncku-thesis-template-latex>
% by Wen-Gan Li.
%
% This project is distributed in the hope of usefuling to someone,
% you can redistribute it and/or modify it under the terms of the
% Attribution-NonCommercial-ShareAlike 4.0 International.
%
% You should have received a copy of the
% Attribution-NonCommercial-ShareAlike 4.0 International
% along with this project.
% If not, see <http://creativecommons.org/licenses/by-nc-sa/4.0/legalcode.txt>.
%
% Please feel free to fork it, modify it, and try it.
% Have fun !!!
%

% Some helper function use in extended abstract

% ----------------------------------------------------------------------------

\def\ValueEnableExtendedAbstractFigureTableControl{1}
\def\ValueDisableExtendedAbstractFigureTableControl{0}
\def\VarStartExtendedAbstractFigureTableControl{%
  \ValueDisableExtendedAbstractFigureTableControl}
\def\BeginExtendedAbstractFigureTableControl{%
  \renewcommand{\VarStartExtendedAbstractFigureTableControl}{%
    \ValueEnableExtendedAbstractFigureTableControl}}
\def\EndExtendedAbstractFigureTableControl{%
  \renewcommand{\VarStartExtendedAbstractFigureTableControl}{%
    \ValueDisableExtendedAbstractFigureTableControl}}
\def\GetStartExtendedAbstractFigureTableControl{%
  \VarStartExtendedAbstractFigureTableControl}

% ----------------------------------------------------------------------------

% Extended Abstract
\newcommand{\StartExtendedAbstract}
{%
  \singlespacing%
  %
  \StartNewPage%
  %
  % Add to "Table of Contents"
%  \addcontentsline{toc}{chapter}{Extended Abstract}
  \addcontentsline{toc}{chapter}{英文延伸摘要}%
  %
  % Set style of caption for figure and table
  \clearcaptionsetup{table}
  \clearcaptionsetup{figure}
  \UseTableCaptionExtendedAbstractStyle%
  \UseFigureCaptionExtendedAbstractStyle%
  %
  \BeginExtendedAbstractFigureTableControl%
  %
  \UseTableNameDefault%
  \UseFigureNameDefault%
  %
  % -----------------------------------------------------------------
  %
  \begin{minipage}[c][5cm][c]{\textwidth}
  \parbox{\textwidth}{\center\large\textbf{\ThesisTitleEng}}
  \vspace{0.3cm}%
  \center\normalsize\AuthorNameEng\par%
  \center\normalsize Dr. \GetAdvisorEngNameA\par%
  \ifthenelse{\equal{\GetAdvisorEngNameB}{\empty}}{}%
    {\center\normalsize Dr. \GetAdvisorEngNameB\par}
  \ifthenelse{\equal{\GetAdvisorEngNameC}{\empty}}{}%
    {\center\normalsize Dr. \GetAdvisorEngNameC\par}
  \center\normalsize\GetDeptEngName\par%
  \center\normalsize\GetCollEngName\par%
%  \center\normalsize\textit{\GetDeptEngName}\\%
%  \center\normalsize\textit{\GetCollEngName}\\%
  \end{minipage}%
  %
} % End of \newcommand{}

\newcommand{\EndExtendedAbstract}
{%
  \EndChapter%
  %
  \EndExtendedAbstractFigureTableControl%
  %
  \UseTableNameCustom%
  \UseFigureNameCustom%
  %
  % Reset figure and table counter to zero
  \setcounter{table}{0}%
  \setcounter{figure}{0}%
  %
  % Reset style of caption of figure and table
  \clearcaptionsetup{table}
  \clearcaptionsetup{figure}
  \UseTableCaptionDefaultStyle%
  \UseFigureCaptionDefaultStyle%
  \SetupNumberingFormat%
  %
  \UseDefaultLineStretch%
} % End of \newcommand{}

% Summary in Extended Abstract
\global\mdfdefinestyle{ExtAbstractSummaryStyle}{%
  linewidth=1pt, apptotikzsetting={%
    \tikzset{mdfbackground/.append style={opacity=0.4}}}%
} % End of \mdfdefinestyle{}
\newcommand{\ExtAbstractSummary}[1]
{%
  \par%
  \vspace{0.3cm}%
  \begin{mdframed}[style=ExtAbstractSummaryStyle]%
  \vspace{0.3cm}%
  \parbox{\textwidth}{\center\textbf{SUMMARY}}%
  \vspace{0.3cm}\par%
  #1%
  \EmptyLine%
%  \vspace{0.3cm}\par%
  \textbf{Keyword:} \GetAbstractExtKeywords%
  \end{mdframed}%
} % End of \newcommand{}

% Chapter in Extended Abstract
%\newcommand{\ExtAbstractChapter}[1]
\DeclareDocumentCommand{\ExtAbstractChapter}{+m +g} % Back-porting
{%
  \par%
  \vspace{0.5cm}%
  \centerline{\textbf{\MakeUppercase{#1}}}\par%
  \vspace{0.3cm}%
  \IfNoValueF{#2}{#2}%
} % End of \newcommand{}

% Section in Extended Abstract
%\newcommand{\ExtAbstractSection}[1]
\DeclareDocumentCommand{\ExtAbstractSection}{+m +g} % Back-porting
{%
  \par%
  \vspace{0.3cm}%
  \textbf{#1}\par%
  \vspace{0.1cm}%
  \IfNoValueF{#2}{#2}%
} % End of \newcommand{}

% ----------------------------------------------------------------------------
