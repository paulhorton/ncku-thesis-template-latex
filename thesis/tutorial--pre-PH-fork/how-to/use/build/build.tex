% ------------------------------------------------
\StartSection{產生論文 Generate Thesis}{chapter:how-to:use:generate}
% ------------------------------------------------

這邊會簡單講解如何安裝基本的程式來產生你的論文.

\StartSubSection{MiKTeX安裝}
首先我們需要MiKTeX來幫我們來轉LaTex成PDF.

  \InsertFigure
    [scale=0.5,
      caption={MiKTeX Logo}]
    {./tutorial--pre-PH-fork/how-to/use/build/pic/miktex/logo.png}

首先去MiKTeX的網頁\RefBib{web:miktex:website}來下載它回來, 它預設在`Recommended Download'是32-bit的, 所以如果你要下載64-bit的話, 就要按`Other Downloads'中的第一個.

  \InsertFigure
    [scale=0.25,
      caption={Download MiKTeX}]
    {./tutorial--pre-PH-fork/how-to/use/build/pic/miktex/mdownload.png}

  \InsertFigure
    [scale=0.4,
      caption={安裝MiKTeX}]
    {./tutorial--pre-PH-fork/how-to/use/build/pic/miktex/minstall.png}

安裝MiKTeX其實沒有什麼需要太在意的東西, 但由獨有一個東西需要設定, 在不停按下一步時, 會出現fig \RefTo{fig:how-to:use:build:package-download}這個畫面, 在這邊推薦選擇`\textbf{Yes}', 因為這邊是用來設定自動幫你下載一些你需要使用的工具來產生論文.

  \InsertFigure
    [scale=0.4,
      caption={Download Package},
      label={fig:how-to:use:build:package-download}]
    {./tutorial--pre-PH-fork/how-to/use/build/pic/miktex/auto-download.png}

最後就要等待安裝, 由於內容滿多, 所以在這邊可能需要等待幾分鐘.

  \InsertFigure
    [scale=0.4,
      caption={等待安裝完成}]
    {./tutorial--pre-PH-fork/how-to/use/build/pic/miktex/installing.png}

\newpage
\StartSubSection{更新MiKTeX}
  不管你是否第一次download MiKTeX, 都應該要定時去更新一些package的版本, 因為新package會可能有性能提升或提供新功能/內容, 如同這模版更新. 如果你看到類似的錯誤訊息, 或其他的寫法, 在說某某package太舊, 那就更加要更新.

  \InsertFigure
    [scale=0.4,
      caption={例子: package<zhnumber>說package<expl3>版本太舊}]
    {./tutorial--pre-PH-fork/how-to/use/build/pic/miktex/version-too-old.png}

  如你在使用Windows的話, 使用路徑去找MiKTeX的Update程式 (必須是Admin那一個):\\
  Start (開始) -> MiKTeX 2.9 -> Maintenance (Admin) -> Update (Admin)

  \InsertFigure
    [scale=0.95,
      caption={在Windows中更新MiKTeX}]
    {./tutorial--pre-PH-fork/how-to/use/build/pic/miktex/windows-start.png}

\newpage
  當開了Update程式後, 應該會看到這個畫面

  \InsertFigure
    [scale=0.65,
      caption={Update程式畫面}]
    {./tutorial--pre-PH-fork/how-to/use/build/pic/miktex/miktex-update-1.png}

  理應直接`下一步'則可, 當然如果你有要求的話, 可選`Let me choose a remote package repository'去選地區來download packages. 不論哪一種, 按`下一步'都會顯示這畫面, 並要等待一些時間 (大約1~幾分鐘).

  \InsertFigure
    [scale=0.65,
      caption={Searching packages}]
    {./tutorial--pre-PH-fork/how-to/use/build/pic/miktex/miktex-update-2.png}

\newpage
  正常情況下, 你會看到所有package都會打勾, 之後你再`下一步'則可更新全部package. 但如果你看到如下圖的情況中, 你沒法選擇`Select All', 這應該是代表有部份miktex或package需優先update, 所以都不用擔心, 直接`下一步'即可. 但如果真的出現這情況, 即是你要更新2次.

  \InsertFigure
    [scale=0.6,
      caption={Select package}]
    {./tutorial--pre-PH-fork/how-to/use/build/pic/miktex/miktex-update-3.png}

  假如你知道要只更新哪一個package即可, 那找你要的package再打勾就好了. 如剛剛的情況是package<expl3>太舊, 那只要更新<l3kernel>和<l3packages>.

  \InsertFigure
    [scale=0.6,
      caption={package <l3kernel> and <l3packages>}]
    {./tutorial--pre-PH-fork/how-to/use/build/pic/miktex/miktex-update-4.png}

  之後就是等待它download和更新. 如果要更新的內容很多, 有可能會需要1小時或以上. 所以當看到正在download時, 你已經可以不用管了.

  \InsertFigure
    [scale=0.65,
      caption={Downloading package}]
    {./tutorial--pre-PH-fork/how-to/use/build/pic/miktex/miktex-update-5.png}

  當update完, 它不會顯示說結束, 但你會看到畫面空掉, 而且有`下一步'可以按, 這代表已更新完了.

  \InsertFigure
    [scale=0.65,
      caption={等待安裝完成}]
    {./tutorial--pre-PH-fork/how-to/use/build/pic/miktex/miktex-update-6.png}

  如果你要再次update, 即是重複這些步驟.

% ------------------------------------------------
\newpage
\StartSubSection{Texmaker安裝}

我們需要Texmaker來幫我們處理產生流程和看PDF用.

  \InsertFigure
    [scale=0.5,
      caption={Texmaker Logo}]
    {./tutorial--pre-PH-fork/how-to/use/build/pic/texmaker/logo.png}

首先去Texmaker的網頁\RefBib{web:texmaker:website}來下載它回來, 推薦使用`Executable file for windows', 同時使用`Alternative download link' (因為這個line是使用Google Drive, 所以速度能有保證).

  \InsertFigure
    [scale=0.25,
      caption={Download Texmaker}]
    {./tutorial--pre-PH-fork/how-to/use/build/pic/texmaker/download.png}

安裝Texmaker其實沒有什麼要設定的東西, 不停按下一步就行了.

  \InsertFigure
    [scale=0.35,
      caption={安裝Texmaker}]
    {./tutorial--pre-PH-fork/how-to/use/build/pic/texmaker/install.png}

  \InsertFigure
    [scale=0.35,
      caption={安裝Texmaker}]
    {./tutorial--pre-PH-fork/how-to/use/build/pic/texmaker/install-2.png}

至於如果更新Texmaker的話, 去網頁download最新版, 之後重複這些步驟即可.

% ------------------------------------------------
\newpage
\StartSubSection{產生論文和封面}

當安裝完Texmaker和MiKTeX後, 直接點開`thesis.tex', 可以看到這個畫面(Fig \RefTo{fig:how-to:use:build:texmaker:thesis.tex}).

  \InsertFigure
    [scale=0.25,
      caption={Texmaker打開thesis.tex畫面},
      label={fig:how-to:use:build:texmaker:thesis.tex}]
    {./tutorial--pre-PH-fork/how-to/use/build/pic/texmaker/1.png}

產生論文的方式為在上方(Fig \RefTo{fig:how-to:use:build:texmaker:to_xelatex})由`快速編譯'改成`XeLaTeX', 之後按左方的箭頭就可以進行產生的處理(註: 如果是第一次使用, 那這時候背後MiKTeX會自動下載一些工具回來, 所以會等待比較久).

  \InsertFigure
    [scale=0.8,
      caption={改使用XeLaTeX},
      label={fig:how-to:use:build:texmaker:to_xelatex}]
    {./tutorial--pre-PH-fork/how-to/use/build/pic/texmaker/2.png}

\newpage
之後只要等待下方出現一些結果(Fig \RefTo{fig:how-to:use:build:texmaker:gen_message})就是說明已產生完成.

  \InsertFigure
    [scale=1.0,
      caption={處理的結果},
      label={fig:how-to:use:build:texmaker:gen_message}]
    {./tutorial--pre-PH-fork/how-to/use/build/pic/texmaker/2-5.png}

如果PDF產生成功, 那接旁邊`瀏覽PDF'的箭頭, 會出現一個視窗(Fig \RefTo{fig:how-to:use:build:texmaker:new_pdf})來顯示那個PDF檔.

  \InsertFigure
    [scale=0.25,
      caption={瀏覽PDF},
      label={fig:how-to:use:build:texmaker:new_pdf}]
    {./tutorial--pre-PH-fork/how-to/use/build/pic/texmaker/3.png}

\newpage
把以上的步驟用在`cover.tex'上(Fig \RefTo{fig:how-to:use:build:texmaker:cover.tex})就能去產生你的封面.

  \InsertFigure
    [scale=0.3,
      caption={Texmaker打開cover.tex畫面},
      label={fig:how-to:use:build:texmaker:cover.tex}]
    {./tutorial--pre-PH-fork/how-to/use/build/pic/texmaker/4.png}

當如果你已經把`thesis.tex'和`cover.tex'都產生了PDF, 你的資料夾應該會有這些檔案和資料夾(Fig \RefTo{fig:how-to:use:build:texmaker:dir}), 那2個PDF正是你需要的東西.

  \InsertFigure
    [scale=0.5,
      caption={資料夾內容},
      label={fig:how-to:use:build:texmaker:dir}]
    {./tutorial--pre-PH-fork/how-to/use/build/pic/texmaker/5.png}

% ------------------------------------------------

\newpage
\StartSubSection{產生PDF的流程}

在編譯LaTex時成PDF時, 必須注意內部的引用(\verb|\RefBib{}|)情況.\\

如果只是編寫內容, 引用的內容和號碼不是重要的話, 那直接使用:\\
\centerline{XeLaTeX -> 瀏覽PDF}
即可.\\

但如果你的PDF是最終版本, 那你的流程則需要使用:\\
\centerline{XeLaTeX -> BibTex -> XeLaTeX -> 瀏覽PDF}
才對.\\

因為第一次的XeLaTeX是用來產生`thesis.aux', 而有這個檔案才能對你的內容中Reference的引用來進行連接, 而BibTex正是做這個的處理以產出`thesis.bbl', 而第二次的XeLaTeX會使用`thesis.bbl'來把你的Reference中的號碼在內容中設定.\\

以上步驟只需用在`thesis.tex'的部份, 而`cover.tex'則不用做這個行為. `cover.tex'直接使用:\\
\centerline{XeLaTeX -> 瀏覽PDF}
即可.\\

如果你在以上的產生流程發現PDF還是有些內容沒法正確顯示, 推薦以下的做法:
\centerline{XeLaTeX -> XeLaTeX -> BibTex -> BibTex -> XeLaTeX -> XeLaTeX -> 瀏覽PDF}
這是為了確保LaTex所使用的內容都是以最新的內容來產生.

\textbf{備註:} 如果碰到一些不明原因的錯誤, 先把所有除了`thesis.tex'外的所有thesis開頭或以thesis為檔名的檔案全刪掉. 例如`thesis.bbl', `thesis.aux', `thesis.lof'等所有檔案. 否則有可能在產生論文時遇到錯誤, 如果遇到錯誤, 請不斷重新刪掉和重新產生論文, 直到解決問題為止. 已知這問題在Reference轉換其他格式時會發生.

% ------------------------------------------------
